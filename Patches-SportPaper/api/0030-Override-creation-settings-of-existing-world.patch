From 2439b472e65d98aa94b4dd9e8ac6b182e42c1513 Mon Sep 17 00:00:00 2001
From: cswhite2000 <18whitechristop@gmail.com>
Date: Wed, 8 Aug 2018 14:55:29 -0700
Subject: [PATCH] Override creation settings of existing world


diff --git a/src/main/java/org/bukkit/Bukkit.java b/src/main/java/org/bukkit/Bukkit.java
index 1d185cdc..a2eb9bdb 100644
--- a/src/main/java/org/bukkit/Bukkit.java
+++ b/src/main/java/org/bukkit/Bukkit.java
@@ -492,6 +492,14 @@ public final class Bukkit {
         return server.getWorlds();
     }
 
+    public static WorldCreator detectWorld(String name) {
+        return server.detectWorld(name);
+    }
+
+    public static World createWorld(String name) {
+        return server.createWorld(name);
+    }
+
     /**
      * Creates or loads a world with the given name using the specified
      * options.
diff --git a/src/main/java/org/bukkit/Server.java b/src/main/java/org/bukkit/Server.java
index 91cd1ad9..693b21be 100644
--- a/src/main/java/org/bukkit/Server.java
+++ b/src/main/java/org/bukkit/Server.java
@@ -402,6 +402,29 @@ public interface Server extends PluginMessageRecipient {
      */
     public List<World> getWorlds();
 
+    /**
+     * Check for a level.dat file belonging to a world with the given name.
+     * If found, return a {@link WorldCreator} configured to match the settings
+     * in the level.dat file. If the file is not found, return null. This works
+     * regardless of whether the world is loaded or not.
+     *
+     * The returned object will have the following fields set explicitly:
+     *  - Name {@link WorldCreator#name()}
+     *  - Type {@link WorldCreator#type()}
+     *  - Seed {@link WorldCreator#seed()}
+     *  - Structure flag {@link WorldCreator#generateStructures()}
+     *  - Generator settings {@link WorldCreator#generatorSettings()}
+     *  - Hardcore flag {@link WorldCreator#hardcore()}
+     */
+    WorldCreator detectWorld(String name);
+
+    /**
+     * Creates or loads a world with the given name. If the world is already loaded,
+     * it will just return the equivalent of getWorld(creator.name()). If the world
+     * is created, {@link #detectWorld} will be called to try and detect settings.
+     */
+    World createWorld(String name);
+
     /**
      * Creates or loads a world with the given name using the specified
      * options.
diff --git a/src/main/java/org/bukkit/WorldCreator.java b/src/main/java/org/bukkit/WorldCreator.java
index 53980fdb..81c95d1f 100644
--- a/src/main/java/org/bukkit/WorldCreator.java
+++ b/src/main/java/org/bukkit/WorldCreator.java
@@ -16,6 +16,7 @@ public class WorldCreator {
     private WorldType type = WorldType.NORMAL;
     private boolean generateStructures = true;
     private String generatorSettings = "";
+    private boolean hardcore;
 
     /**
      * Creates an empty WorldCreationOptions for the given world name
@@ -249,6 +250,15 @@ public class WorldCreator {
         return generateStructures;
     }
 
+    public WorldCreator hardcore(boolean hardcore) {
+        this.hardcore = hardcore;
+        return this;
+    }
+
+    public boolean hardcore() {
+        return hardcore;
+    }
+
     /**
      * Creates a world with the specified options.
      * <p>
-- 
2.19.0

