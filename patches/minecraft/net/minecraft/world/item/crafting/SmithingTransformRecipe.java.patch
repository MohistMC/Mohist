--- a/net/minecraft/world/item/crafting/SmithingTransformRecipe.java
+++ b/net/minecraft/world/item/crafting/SmithingTransformRecipe.java
@@ -1,108 +_,115 @@
 package net.minecraft.world.item.crafting;
 
-import com.mojang.serialization.MapCodec;
+import com.mohistmc.mohist.bukkit.inventory.MohistSpecialRecipe;
+import com.mojang.serialization.Codec;
 import com.mojang.serialization.codecs.RecordCodecBuilder;
-import com.mojang.serialization.codecs.RecordCodecBuilder.Instance;
 import java.util.stream.Stream;
-import net.minecraft.core.HolderLookup;
-import net.minecraft.network.RegistryFriendlyByteBuf;
-import net.minecraft.network.codec.StreamCodec;
+import net.minecraft.core.RegistryAccess;
+import net.minecraft.nbt.CompoundTag;
+import net.minecraft.network.FriendlyByteBuf;
 import net.minecraft.world.Container;
 import net.minecraft.world.item.ItemStack;
 import net.minecraft.world.level.Level;
+import org.bukkit.NamespacedKey;
+import org.bukkit.craftbukkit.inventory.CraftItemStack;
+import org.bukkit.craftbukkit.inventory.CraftRecipe;
+import org.bukkit.craftbukkit.inventory.CraftSmithingTransformRecipe;
 
 public class SmithingTransformRecipe implements SmithingRecipe {
-    final Ingredient template;
-    final Ingredient base;
-    final Ingredient addition;
-    final ItemStack result;
-
-    public SmithingTransformRecipe(Ingredient p_266750_, Ingredient p_266787_, Ingredient p_267292_, ItemStack p_267031_) {
-        this.template = p_266750_;
-        this.base = p_266787_;
-        this.addition = p_267292_;
-        this.result = p_267031_;
-    }
-
-    @Override
-    public boolean matches(Container p_266855_, Level p_266781_) {
-        return this.template.test(p_266855_.getItem(0)) && this.base.test(p_266855_.getItem(1)) && this.addition.test(p_266855_.getItem(2));
-    }
-
-    @Override
-    public ItemStack assemble(Container p_267036_, HolderLookup.Provider p_331030_) {
-        ItemStack itemstack = p_267036_.getItem(1).transmuteCopy(this.result.getItem(), this.result.getCount());
-        itemstack.applyComponents(this.result.getComponentsPatch());
-        return itemstack;
-    }
-
-    @Override
-    public ItemStack getResultItem(HolderLookup.Provider p_330801_) {
-        return this.result;
-    }
-
-    @Override
-    public boolean isTemplateIngredient(ItemStack p_267113_) {
-        return this.template.test(p_267113_);
-    }
-
-    @Override
-    public boolean isBaseIngredient(ItemStack p_267276_) {
-        return this.base.test(p_267276_);
-    }
-
-    @Override
-    public boolean isAdditionIngredient(ItemStack p_267260_) {
-        return this.addition.test(p_267260_);
-    }
-
-    @Override
-    public RecipeSerializer<?> getSerializer() {
-        return RecipeSerializer.SMITHING_TRANSFORM;
-    }
-
-    @Override
-    public boolean isIncomplete() {
-        return Stream.of(this.template, this.base, this.addition).anyMatch(Ingredient::isEmpty);
-    }
-
-    public static class Serializer implements RecipeSerializer<SmithingTransformRecipe> {
-        private static final MapCodec<SmithingTransformRecipe> CODEC = RecordCodecBuilder.mapCodec(
-            p_327220_ -> p_327220_.group(
-                        Ingredient.CODEC.fieldOf("template").forGetter(p_297231_ -> p_297231_.template),
-                        Ingredient.CODEC.fieldOf("base").forGetter(p_298250_ -> p_298250_.base),
-                        Ingredient.CODEC.fieldOf("addition").forGetter(p_299654_ -> p_299654_.addition),
-                        ItemStack.STRICT_CODEC.fieldOf("result").forGetter(p_297480_ -> p_297480_.result)
-                    )
-                    .apply(p_327220_, SmithingTransformRecipe::new)
-        );
-        public static final StreamCodec<RegistryFriendlyByteBuf, SmithingTransformRecipe> STREAM_CODEC = StreamCodec.of(
-            SmithingTransformRecipe.Serializer::toNetwork, SmithingTransformRecipe.Serializer::fromNetwork
-        );
-
-        @Override
-        public MapCodec<SmithingTransformRecipe> codec() {
-            return CODEC;
-        }
-
-        @Override
-        public StreamCodec<RegistryFriendlyByteBuf, SmithingTransformRecipe> streamCodec() {
-            return STREAM_CODEC;
-        }
-
-        private static SmithingTransformRecipe fromNetwork(RegistryFriendlyByteBuf p_333917_) {
-            Ingredient ingredient = Ingredient.CONTENTS_STREAM_CODEC.decode(p_333917_);
-            Ingredient ingredient1 = Ingredient.CONTENTS_STREAM_CODEC.decode(p_333917_);
-            Ingredient ingredient2 = Ingredient.CONTENTS_STREAM_CODEC.decode(p_333917_);
-            ItemStack itemstack = ItemStack.STREAM_CODEC.decode(p_333917_);
-            return new SmithingTransformRecipe(ingredient, ingredient1, ingredient2, itemstack);
-        }
-
-        private static void toNetwork(RegistryFriendlyByteBuf p_329920_, SmithingTransformRecipe p_266927_) {
-            Ingredient.CONTENTS_STREAM_CODEC.encode(p_329920_, p_266927_.template);
-            Ingredient.CONTENTS_STREAM_CODEC.encode(p_329920_, p_266927_.base);
-            Ingredient.CONTENTS_STREAM_CODEC.encode(p_329920_, p_266927_.addition);
-            ItemStack.STREAM_CODEC.encode(p_329920_, p_266927_.result);
-        }
-    }
+   final Ingredient template;
+   final Ingredient base;
+   final Ingredient addition;
+   final ItemStack result;
+
+   public SmithingTransformRecipe(Ingredient p_266750_, Ingredient p_266787_, Ingredient p_267292_, ItemStack p_267031_) {
+      this.template = p_266750_;
+      this.base = p_266787_;
+      this.addition = p_267292_;
+      this.result = p_267031_;
+   }
+
+   public boolean matches(Container p_266855_, Level p_266781_) {
+      return this.template.test(p_266855_.getItem(0)) && this.base.test(p_266855_.getItem(1)) && this.addition.test(p_266855_.getItem(2));
+   }
+
+   public ItemStack assemble(Container p_267036_, RegistryAccess p_266699_) {
+      ItemStack itemstack = this.result.copy();
+      CompoundTag compoundtag = p_267036_.getItem(1).getTag();
+      if (compoundtag != null) {
+         itemstack.setTag(compoundtag.copy());
+      }
+
+      return itemstack;
+   }
+
+   public ItemStack getResultItem(RegistryAccess p_267209_) {
+      return this.result;
+   }
+
+   public boolean isTemplateIngredient(ItemStack p_267113_) {
+      return this.template.test(p_267113_);
+   }
+
+   public boolean isBaseIngredient(ItemStack p_267276_) {
+      return this.base.test(p_267276_);
+   }
+
+   public boolean isAdditionIngredient(ItemStack p_267260_) {
+      return this.addition.test(p_267260_);
+   }
+
+   public RecipeSerializer<?> getSerializer() {
+      return RecipeSerializer.SMITHING_TRANSFORM;
+   }
+
+   public boolean isIncomplete() {
+      return Stream.of(this.template, this.base, this.addition).anyMatch(net.minecraftforge.common.ForgeHooks::hasNoElements);
+   }
+
+   // CraftBukkit start
+   @Override
+   public org.bukkit.inventory.Recipe toBukkitRecipe(NamespacedKey id) {
+      if (this.result.isEmpty()) {
+         return new MohistSpecialRecipe(id, this);
+      }
+      CraftItemStack result = CraftItemStack.asCraftMirror(this.result);
+
+      CraftSmithingTransformRecipe recipe = new CraftSmithingTransformRecipe(id, result, CraftRecipe.toBukkit(this.template), CraftRecipe.toBukkit(this.base), CraftRecipe.toBukkit(this.addition));
+
+      return recipe;
+   }
+   // CraftBukkit end
+
+   public static class Serializer implements RecipeSerializer<SmithingTransformRecipe> {
+      private static final Codec<SmithingTransformRecipe> CODEC = RecordCodecBuilder.create((p_309262_) -> {
+         return p_309262_.group(Ingredient.CODEC.fieldOf("template").forGetter((p_297231_) -> {
+            return p_297231_.template;
+         }), Ingredient.CODEC.fieldOf("base").forGetter((p_298250_) -> {
+            return p_298250_.base;
+         }), Ingredient.CODEC.fieldOf("addition").forGetter((p_299654_) -> {
+            return p_299654_.addition;
+         }), ItemStack.ITEM_WITH_COUNT_CODEC.fieldOf("result").forGetter((p_297480_) -> {
+            return p_297480_.result;
+         })).apply(p_309262_, SmithingTransformRecipe::new);
+      });
+
+      public Codec<SmithingTransformRecipe> codec() {
+         return CODEC;
+      }
+
+      public SmithingTransformRecipe fromNetwork(FriendlyByteBuf p_267316_) {
+         Ingredient ingredient = Ingredient.fromNetwork(p_267316_);
+         Ingredient ingredient1 = Ingredient.fromNetwork(p_267316_);
+         Ingredient ingredient2 = Ingredient.fromNetwork(p_267316_);
+         ItemStack itemstack = p_267316_.readItem();
+         return new SmithingTransformRecipe(ingredient, ingredient1, ingredient2, itemstack);
+      }
+
+      public void toNetwork(FriendlyByteBuf p_266746_, SmithingTransformRecipe p_266927_) {
+         p_266927_.template.toNetwork(p_266746_);
+         p_266927_.base.toNetwork(p_266746_);
+         p_266927_.addition.toNetwork(p_266746_);
+         p_266746_.writeItem(p_266927_.result);
+      }
+   }
 }
