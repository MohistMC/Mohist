--- a/net/minecraft/client/server/IntegratedServer.java
+++ b/net/minecraft/client/server/IntegratedServer.java
@@ -15,6 +_,7 @@
 import net.minecraft.SharedConstants;
 import net.minecraft.SystemReport;
 import net.minecraft.client.Minecraft;
+import net.minecraft.commands.CommandSourceStack;
 import net.minecraft.core.RegistryAccess;
 import net.minecraft.server.MinecraftServer;
 import net.minecraft.server.ServerResources;
@@ -25,6 +_,7 @@
 import net.minecraft.stats.Stats;
 import net.minecraft.util.ModCheck;
 import net.minecraft.util.profiling.ProfilerFiller;
+import net.minecraft.world.level.DataPackConfig;
 import net.minecraft.world.level.GameType;
 import net.minecraft.world.level.storage.LevelStorageSource;
 import net.minecraft.world.level.storage.WorldData;
@@ -32,6 +_,7 @@
 import net.minecraftforge.api.distmarker.OnlyIn;
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
+import org.bukkit.command.CommandSender;
 
 @OnlyIn(Dist.CLIENT)
 public class IntegratedServer extends MinecraftServer {
@@ -48,8 +_,8 @@
    private UUID f_120019_;
    private int f_194467_ = 0;
 
-   public IntegratedServer(Thread p_120022_, Minecraft p_120023_, RegistryAccess.RegistryHolder p_120024_, LevelStorageSource.LevelStorageAccess p_120025_, PackRepository p_120026_, ServerResources p_120027_, WorldData p_120028_, MinecraftSessionService p_120029_, GameProfileRepository p_120030_, GameProfileCache p_120031_, ChunkProgressListenerFactory p_120032_) {
-      super(p_120022_, p_120024_, p_120025_, p_120028_, p_120026_, p_120023_.m_91096_(), p_120023_.m_91295_(), p_120027_, p_120029_, p_120030_, p_120031_, p_120032_);
+   public IntegratedServer( joptsimple.OptionSet p_139607_, DataPackConfig p_139608_, Thread p_120022_, Minecraft p_120023_, RegistryAccess.RegistryHolder p_120024_, LevelStorageSource.LevelStorageAccess p_120025_, PackRepository p_120026_, ServerResources p_120027_, WorldData p_120028_, MinecraftSessionService p_120029_, GameProfileRepository p_120030_, GameProfileCache p_120031_, ChunkProgressListenerFactory p_120032_) {
+      super(p_139607_, p_139608_, p_120022_, p_120024_, p_120025_, p_120028_, p_120026_, p_120023_.m_91096_(), p_120023_.m_91295_(), p_120027_, p_120029_, p_120030_, p_120031_, p_120032_);
       this.m_129981_(p_120023_.m_91094_().m_92546_());
       this.m_129975_(p_120023_.m_91402_());
       this.m_129823_(new IntegratedPlayerList(this, this.f_129746_, this.f_129745_));
@@ -62,9 +_,10 @@
       this.m_129997_(true);
       this.m_129999_(true);
       this.m_129793_();
+      if (!net.minecraftforge.server.ServerLifecycleHooks.handleServerAboutToStart(this)) return false;
       this.m_130006_();
       this.m_129989_(this.m_129791_() + " - " + this.m_129910_().m_5462_());
-      return true;
+      return net.minecraftforge.server.ServerLifecycleHooks.handleServerStarting(this);
    }
 
    public void m_5705_(BooleanSupplier p_120049_) {
@@ -114,6 +_,11 @@
       return true;
    }
 
+   @Override
+   public CommandSender getBukkitSender(CommandSourceStack wrapper) {
+      return null;
+   }
+
    public File m_6237_() {
       return this.f_120015_.f_91069_;
    }
@@ -181,10 +_,11 @@
    }
 
    public void m_7570_(boolean p_120053_) {
+      if (m_130010_())
       this.m_18709_(() -> {
          for(ServerPlayer serverplayer : Lists.newArrayList(this.m_6846_().m_11314_())) {
             if (!serverplayer.m_142081_().equals(this.f_120019_)) {
-               this.m_6846_().m_11286_(serverplayer);
+               this.m_6846_().remove(serverplayer);
             }
          }
 
