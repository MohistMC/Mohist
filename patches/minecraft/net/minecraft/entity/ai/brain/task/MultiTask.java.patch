--- a/net/minecraft/entity/ai/brain/task/MultiTask.java
+++ b/net/minecraft/entity/ai/brain/task/MultiTask.java
@@ -7,10 +7,13 @@
 import java.util.function.Consumer;
 import java.util.stream.Collectors;
 import net.minecraft.entity.LivingEntity;
+import net.minecraft.entity.ai.brain.Brain;
 import net.minecraft.entity.ai.brain.memory.MemoryModuleStatus;
 import net.minecraft.entity.ai.brain.memory.MemoryModuleType;
 import net.minecraft.util.WeightedList;
 import net.minecraft.world.server.ServerWorld;
+import red.mohist.extra.ExtraExtendTask;
+import red.mohist.extra.ExtraIIterableWeightedList;
 
 public class MultiTask<E extends LivingEntity> extends Task<E> {
    private final Set<MemoryModuleType<?>> field_220416_b;
@@ -28,12 +31,15 @@
       });
    }
 
-   protected boolean func_212834_g_(ServerWorld p_212834_1_, E p_212834_2_, long p_212834_3_) {
-      return this.field_220419_e.func_220655_b().filter((p_220414_0_) -> {
-         return p_220414_0_.func_220376_b() == Task.Status.RUNNING;
-      }).anyMatch((p_220413_4_) -> {
-         return p_220413_4_.func_212834_g_(p_212834_1_, p_212834_2_, p_212834_3_);
-      });
+   public boolean func_212834_g_(ServerWorld p_212834_1_, E p_212834_2_, long p_212834_3_) {
+      for (Task<? super E> task : ExtraIIterableWeightedList.cast(this.field_220419_e)) {
+         if (task.func_220376_b() == Task.Status.RUNNING) {
+            if (((ExtraExtendTask<? super E>) task).shouldContinueExecuting(p_212834_1_, p_212834_2_, p_212834_3_)) {
+               return true;
+            }
+         }
+      }
+      return false;
    }
 
    protected boolean func_220383_a(long p_220383_1_) {
@@ -45,21 +51,26 @@
       this.field_220418_d.func_220630_a(this.field_220419_e, p_212831_1_, p_212831_2_, p_212831_3_);
    }
 
-   protected void func_212833_d_(ServerWorld p_212833_1_, E p_212833_2_, long p_212833_3_) {
-      this.field_220419_e.func_220655_b().filter((p_220408_0_) -> {
-         return p_220408_0_.func_220376_b() == Task.Status.RUNNING;
-      }).forEach((p_220409_4_) -> {
-         p_220409_4_.func_220377_c(p_212833_1_, p_212833_2_, p_212833_3_);
-      });
+   public void func_212833_d_(ServerWorld p_212833_1_, E p_212833_2_, long p_212833_3_) {
+      for (Task<? super E> task : ExtraIIterableWeightedList.cast(this.field_220419_e)) {
+         if (task.func_220376_b() == Task.Status.RUNNING) {
+            task.func_220377_c(p_212833_1_, p_212833_2_, p_212833_3_);
+         }
+      }
    }
 
-   protected void func_212835_f_(ServerWorld p_212835_1_, E p_212835_2_, long p_212835_3_) {
-      this.field_220419_e.func_220655_b().filter((p_220407_0_) -> {
-         return p_220407_0_.func_220376_b() == Task.Status.RUNNING;
-      }).forEach((p_220412_4_) -> {
-         p_220412_4_.func_220380_e(p_212835_1_, p_212835_2_, p_212835_3_);
-      });
-      this.field_220416_b.forEach(p_212835_2_.func_213375_cj()::func_218189_b);
+   public void func_212835_f_(ServerWorld p_212835_1_, E p_212835_2_, long p_212835_3_) {
+      for (Task<? super E> task : ExtraIIterableWeightedList.cast(this.field_220419_e)) {
+         if (task.func_220376_b() == Task.Status.RUNNING) {
+            task.func_220380_e(p_212835_1_, p_212835_2_, p_212835_3_);
+         }
+      }
+
+      Brain<?> brain = p_212835_2_.func_213375_cj();
+
+      for (MemoryModuleType<?> module : this.field_220416_b) {
+         brain.func_218189_b(module);
+      }
    }
 
    public String toString() {
